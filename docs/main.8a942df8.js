parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Tx6Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.letterPatterns=["\n  w\n  w\n  w\n\n  w\n","\n w w\n w w\n\n\n\n","\n w w\nwwwww\n w w\nwwwww\n w w\n","\n www\nw w\n www\n  w w\n www\n","\nw   w\nw  w\n  w\n w  w\nw   w\n","\n w\nw w\n ww w\nw  w\n ww w\n","\n  w\n  w\n\n\n\n","\n   w\n  w\n  w\n  w\n   w\n","\n w\n  w\n  w\n  w\n w\n","\n  w\nw w w\n www\nw w w\n  w\n","\n  w\n  w\nwwwww\n  w\n  w\n","\n\n\n\n  w\n w\n","\n\n\nwwwww\n\n\n","\n\n\n\n\n  w\n","\n    w\n   w\n  w\n w\nw\n","\n www\nw  ww\nw w w\nww  w\n www\n","\n ww\nw w\n  w\n  w\nwwwww\n","\n www\nw   w\n  ww\n w\nwwwww\n","\n www\nw   w\n  ww\nw   w\n www\n","\n  ww\n w w\nw  w\nwwwww\n   w\n","\nwwwww\nw\nwwww\n    w\nwwww\n","\n www\nw\nwwww\nw   w\n www\n","\nwwwww\nw   w\n   w\n  w\n w\n","\n www\nw   w\n www\nw   w\n www\n","\n www\nw   w\n wwww\n    w\n www\n","\n\n  w\n\n  w\n\n","\n\n  w\n\n  w\n w\n","\n   ww\n ww\nw\n ww\n   ww\n","\n\nwwwww\n\nwwwww\n\n","\nww\n  ww\n    w\n  ww\nww\n","\n www\nw   w\n  ww\n\n  w\n","\n www\nw   w\nw www\nw\n www\n","\n www\nw   w\nwwwww\nw   w\nw   w\n","\nwwww\nw   w\nwwww\nw   w\nwwww\n","\n www\nw   w\nw\nw   w\n www\n","\nwwww\nw   w\nw   w\nw   w\nwwww\n","\nwwwww\nw\nwwww\nw\nwwwww\n","\nwwwww\nw\nwwww\nw\nw\n","\n www\nw\nw  ww\nw   w\n wwww\n","\nw   w\nw   w\nwwwww\nw   w\nw   w\n","\nwwwww\n  w\n  w\n  w\nwwwww\n","\n wwww\n   w\n   w\nw  w\n ww\n","\nw   w\nw  w\nwww\nw  w\nw   w\n","\nw\nw\nw\nw\nwwwww\n","\nw   w\nww ww\nw w w\nw   w\nw   w\n","\nw   w\nww  w\nw w w\nw  ww\nw   w\n","\n www\nw   w\nw   w\nw   w\n www\n","\nwwww\nw   w\nwwww\nw\nw\n","\n www\nw   w\nw   w\nw  ww\n wwww\n","\nwwww\nw   w\nwwww\nw   w\nw   w\n","\n wwww\nw\n www\n    w\nwwww\n","\nwwwww\n  w\n  w\n  w\n  w\n","\nw   w\nw   w\nw   w\nw   w\n www\n","\nw   w\nw   w\n w w\n w w\n  w\n","\nw   w\nw   w\nw w w\nw w w\n w w\n","\nw   w\n w w\n  w\n w w\nw   w\n","\nw   w\n w w\n  w\n  w\n  w\n","\nwwwww\n   w\n  w\n w\nwwwww\n","\n  ww\n  w\n  w\n  w\n  ww\n","\nw\n w\n  w\n   w\n    w\n","\n ww\n  w\n  w\n  w\n ww\n","\n  w\n w w\n\n\n\n","\n\n\n\n\nwwwww\n","\n w\n  w\n\n\n\n","\n ww\n   w\n www\nw  w\n ww\n","\nw\nw\nwww\nw  w\nwww\n","\n\n ww\nw  \nw\n ww\n","\n   w\n   w\n www\nw  w\n www\n","\n ww\nw  w\nwww\nw\n ww\n","\n   w\n  w \n www\n  w\n  w\n","\n www\nw  w\n www\n   w\n ww\n","\nw\nw\nwww\nw  w\nw  w\n","\n  w\n\n  w\n  w\n  w\n","\n   w\n\n   w\n   w\n ww\n","\nw\nw\nw w\nww\nw w\n","\n ww\n  w\n  w\n  w\n www\n","\n\nww w\nw w w\nw w w\nw w w\n","\n\nw ww\nww  w\nw   w\nw   w\n","\n\n ww\nw  w\nw  w\n ww\n","\n\nwww\nw  w\nwww\nw\n","\n\n www\nw  w\n www\n   w\n","\n\nw ww\nww\nw\nw\n","\n ww\nw\n ww  \n   w\n ww\n","\n w\nwww\n w\n w\n  w\n","\n\nw  w\nw  w\nw  w\n ww\n","\n\nw  w\nw  w\n ww\n ww\n","\n\nw w w\nw w w\nw w w\n w w\n","\n\nw  w\n ww\n ww\nw  w\n","\n\nw  w\n ww\n w\nw\n","\n\nwwww\n  w\n w\nwwww\n","\n  ww\n  w\n w\n  w\n  ww\n","\n  w\n  w\n  w\n  w\n  w\n","\n ww\n  w\n   w\n  w\n ww\n","\n\n w\nw w w\n   w\n\n"];
},{}],"pR4u":[function(require,module,exports) {
"use strict";function t(t,r=0,e=1){return Math.max(r,Math.min(t,e))}function r(t,r,e){const n=e-r,o=t-r;if(o>=0)return o%n+r;{let t=n+o%n+r;return t>=e&&(t-=n),t}}function e(t,r,e){return r<=t&&t<e}function n(t){return[...Array(t).keys()]}function o(t,r){null==r&&(r=((t,r)=>t-r));const e=t.map((t,r)=>[t,r]);return e.sort((t,e)=>{const n=r(t[0],e[0]);return 0!==n?n:t[1]-e[1]}),e.map(t=>t[0])}Object.defineProperty(exports,"__esModule",{value:!0}),exports.clamp=t,exports.wrap=r,exports.isInRange=e,exports.range=n,exports.stableSort=o;
},{}],"HIZ7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./math");function s(t){return null!=t.x&&null!=t.y}class h{constructor(t,s){this.x=0,this.y=0,this.set(t,s)}set(t=0,h=0){return s(t)?(this.x=t.x,this.y=t.y,this):(this.x=t,this.y=h,this)}add(t,h){return s(t)?(this.x+=t.x,this.y+=t.y,this):(this.x+=t,this.y+=h,this)}sub(t,h){return s(t)?(this.x-=t.x,this.y-=t.y,this):(this.x-=t,this.y-=h,this)}mul(t){return this.x*=t,this.y*=t,this}div(t){return this.x/=t,this.y/=t,this}clamp(s,h,i,r){return this.x=t.clamp(this.x,s,h),this.y=t.clamp(this.y,i,r),this}wrap(s,h,i,r){return this.x=t.wrap(this.x,s,h),this.y=t.wrap(this.y,i,r),this}addWithAngle(t,s){return this.x+=Math.cos(t)*s,this.y+=Math.sin(t)*s,this}swapXy(){const t=this.x;return this.x=this.y,this.y=t,this}normalize(){return this.div(this.length),this}rotate(t){if(0===t)return this;const s=this.x;return this.x=s*Math.cos(t)-this.y*Math.sin(t),this.y=s*Math.sin(t)+this.y*Math.cos(t),this}getAngle(t){return null==t?Math.atan2(this.y,this.x):Math.atan2(t.y-this.y,t.x-this.x)}distanceTo(t){const s=this.x-t.x,h=this.y-t.y;return Math.sqrt(s*s+h*h)}isInRect(s,h,i,r){return t.isInRange(this.x,s,s+i)&&t.isInRange(this.y,h,h+r)}equals(t){return this.x===t.x&&this.y===t.y}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}}exports.Vector=h;
},{"./math":"pR4u"}],"YCKg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./vector");let t;exports.size=new e.Vector;const s="\nposition: absolute;\nleft: 50%;\ntop: 50%;\ntransform: translate(-50%, -50%);\nimage-rendering: -moz-crisp-edges;\nimage-rendering: -webkit-optimize-contrast;\nimage-rendering: -o-crisp-edges;\nimage-rendering: pixelated;\n";let n="black";function o(e,o,r){exports.size.set(e),n=r,t=`\n-webkit-touch-callout: none;\n-webkit-tap-highlight-color: ${o};\n-webkit-user-select: none;\n-moz-user-select: none;\n-ms-user-select: none;\nuser-select: none;\nbackground: ${o};\ncolor: #888;\n`,document.body.style.cssText=t,exports.canvas=document.createElement("canvas"),exports.canvas.width=exports.size.x,exports.canvas.height=exports.size.y,exports.canvas.style.cssText=s;const i=exports.size.x>=exports.size.y?95:95/exports.size.y*exports.size.x,c=exports.size.y>=exports.size.x?95:95/exports.size.x*exports.size.y;exports.canvas.style.width=`${i}vmin`,exports.canvas.style.height=`${c}vmin`,exports.context=exports.canvas.getContext("2d"),exports.context.imageSmoothingEnabled=!1,document.body.appendChild(exports.canvas)}function r(){exports.context.fillStyle=n,exports.context.fillRect(0,0,exports.size.x,exports.size.y)}exports.init=o,exports.clear=r;
},{"./vector":"HIZ7"}],"RRtf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.symbolPatterns=["\n  w\n   w\nwwwww\n   w\n  w\n","\nwwwwww\nwwwwww\nwwwww\nwwwww\nwwww\nww\n","\n ww\nwwww\nwwww\n ww\n","\nwww\nwww\nwww\n\n\n\n","\n  w\n  w\n  w\n  w\n  w\n  w  \n","\nwwwwww\nwwwwww\nwwwwww\n\n\n\n","\nwww\nwww\nwww\n   www\n   www\n   www\n","\nwwww\nw  w\nw  w\nwwww\n","\n  w\n w w\n w w\nw   w\nwwwww\n","\n  w\n  w\nwww\n\n\n\n","\n  w\n  w\nwwwwww\n\n\n\n","\n  w\n  w\nwwwwwww\n  w\n  w\n  w\n","\n  w\n  w\nww\n\n\n\n","\n ww\nw  w\nw  w\n ww\n","\n  w\n w\nw\n\n\n\n","\n     w\n    w\n   w\n  w\n w\nw\n","\n  ww\n  ww\nwwwwww\n  ww\n w  w\nw    w\n","\n wwww\nw    w\nww  ww\nw    w\nw ww w\n wwww \n","\nwwww\nwwww\nwwww\nwwww\n","\n  w\n www\n www\nwwwww\nwwwww\n","\nwwwwww\nwwwww\nwwww\nwww\nww\nw\n","\nwww\nwww\nww\n\n\n\n","\nw w w\n w w w\nw w w\n w w w\nw w w\n w w w\n","\nw    w\n w  w\n  ww\n  ww\n w  w\nw    w\n","\nwww\nww\nw\n\n\n\n","\nw\n w\n  w w\n   ww\n  www\n"];
},{}],"souV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./letterPattern"),r=require("./view"),e=require("./math"),o=require("./symbolPattern");let l,n,s,i,a,c=!1;const p=6,u=1;exports.letterSize=p*u;const x=[void 0,0,15277667,5025616,16771899,4149685,10233776,240116,15658734];function h(){(i=document.createElement("canvas")).width=i.height=exports.letterSize,a=i.getContext("2d"),exports.rgbObjects=[],x.forEach(t=>{exports.rgbObjects.push({r:(16711680&t)>>16,g:(65280&t)>>8,b:255&t})}),x.forEach((t,r)=>{r<2||exports.rgbObjects.push({r:Math.floor(.5*(16711680&t))>>16,g:Math.floor(.5*(65280&t))>>8,b:Math.floor(.5*(255&t))})}),l=t.letterPatterns.map(t=>P(t)),n=e.range(64).map(()=>void 0),g(o.symbolPatterns,"a"),s={}}function g(t,r){const e=r.charCodeAt(0)-33;t.forEach((t,r)=>{n[e+r]=P(t)})}function f(){c=!0}function b(t,r,e,o={}){const l=Math.floor(r);let n=null!=o.colorPattern?o.colorPattern.split("\n"):void 0;const s=null!=o.backgroundColorPattern?o.backgroundColorPattern.split("\n"):void 0,i=null!=o.rotationPattern?o.rotationPattern.split("\n"):void 0,a=null!=o.symbolPattern?o.symbolPattern.split("\n"):void 0,c=null==o.scale?1:o.scale,p=null==o.alpha?1:o.alpha;let u=t;if(null!=o.charAndColorPattern){const[t,r]=m(o.charAndColorPattern);u=t.join("\n"),n=r}let x=l,h=Math.floor(e),g=0,f=0;for(let b=0;b<u.length;b++){const t=u[b];"\n"!==t?(O(t,x,h,Object.assign(Object.assign({},S(null!=o.color?o.color:M(n,g,f),null!=o.backgroundColor?o.backgroundColor:M(s,g,f),null!=o.rotation?o.rotation:M(i,g,f),null!=o.symbol?o.symbol:M(a,g,f))),{scale:c,alpha:p})),x+=exports.letterSize*c,g++):(x=l,h+=exports.letterSize*c,g=0,f++)}}function d(t){const e=exports.rgbObjects[exports.colorChars.indexOf(t)];r.context.fillStyle=`rgb(${e.r},${e.g},${e.b})`}function m(t){const r=t.split("\n"),e=r.slice(1,r.length-1),o=[],l=[];let n=!0;for(const s of e)n?(o.push(s),n=!1):C(s)?(l.push(s),n=!0):(o.push(s),l.push(""));return[o,l]}function C(t){return t.trim().length>0&&0===t.replace(new RegExp(`[\\s${exports.colorChars}]`,"g"),"").length}function M(t,r,e){if(null==t)return;if(e>=t.length)return;const o=t[e].charAt(r);return""===o||" "===o?void 0:o}function S(t,r,e,o){let l={color:"w",backgroundColor:"t",angleIndex:0,isMirrorX:!1,isMirrorY:!1,isSymbol:!1};if(null!=t&&y(t)&&(l.color=t),null!=r&&y(r)&&(l.backgroundColor=r),null!=e){const t=exports.rotationChars.indexOf(e);t>=0&&(l.angleIndex=t%4,l.isMirrorX=(4&t)>0,l.isMirrorY=(8&t)>0)}return"s"===o&&(l.isSymbol=!0),l}function O(t,e,o,p){const u=t.charCodeAt(0);if(u<32||u>126)return;const x=exports.letterSize*p.scale;if("t"!==p.backgroundColor){const t=exports.rgbObjects[exports.colorChars.indexOf(p.backgroundColor)];r.context.fillStyle=`rgba(${t.r},${t.g},${t.b},${Math.floor(255*p.alpha)})`,r.context.fillRect(e,o,x,x)}if(32==u||"t"===p.color)return;const h=u-33,g=p.isSymbol?n[h]:l[h];if("w"===p.color&&p.angleIndex%4==0&&!p.isMirrorX&&!p.isMirrorY&&1===p.alpha)return void(1===p.scale?r.context.drawImage(g,e,o):r.context.drawImage(g,e,o,x,x));const f=JSON.stringify({c:t,options:p}),b=s[f];if(null==b){if(a.clearRect(0,0,exports.letterSize,exports.letterSize),a.globalAlpha=p.alpha,p.angleIndex%4!=0||p.isMirrorX||p.isMirrorY?(a.save(),a.translate(exports.letterSize/2,exports.letterSize/2),a.rotate(Math.PI/2*p.angleIndex),(p.isMirrorX||p.isMirrorY)&&a.scale(p.isMirrorX?-1:1,p.isMirrorY?-1:1),a.drawImage(g,-exports.letterSize/2,-exports.letterSize/2),a.restore()):a.drawImage(g,0,0),"w"!==p.color){a.globalCompositeOperation="source-in";const t=exports.rgbObjects[exports.colorChars.indexOf(p.color)];a.fillStyle=`rgb(${t.r},${t.g},${t.b})`,a.fillRect(0,0,exports.letterSize,exports.letterSize),a.globalCompositeOperation="source-over"}if(r.context.drawImage(i,e,o,x,x),c){const t=document.createElement("img");t.src=i.toDataURL(),s[f]=t}}else r.context.drawImage(b,e,o)}function y(t){return exports.colorChars.indexOf(t)>=0}function P(t,r=!0){a.clearRect(0,0,exports.letterSize,exports.letterSize);let e=t.split("\n");r&&(e=e.slice(1,e.length-1));let o=0;e.forEach(t=>{o=Math.max(t.length,o)});const l=Math.max(Math.ceil((p-o)/2),0),n=e.length,s=Math.max(Math.ceil((p-n)/2),0);e.forEach((t,r)=>{if(!(r+s>=p))for(let e=0;e<p-l;e++){const o=t.charAt(e);let n=exports.colorChars.indexOf(o);if(""!==o&&n>=1){const t=exports.rgbObjects[n];a.fillStyle=`rgb(${t.r},${t.g},${t.b})`,a.fillRect((e+l)*u,(r+s)*u,u,u)}}});const c=document.createElement("img");return c.src=i.toDataURL(),c}exports.colorChars="tlrgybpcwRGYBPCW",exports.rotationChars="kljhnmbvopiu9087",exports.init=h,exports.defineSymbols=g,exports.enableCache=f,exports.print=b,exports.setColor=d,exports.getColorLines=m,exports.isColorLine=C,exports.getCharFromLines=M,exports.getCharOption=S,exports.printChar=O;
},{"./letterPattern":"Tx6Z","./view":"YCKg","./math":"pR4u","./symbolPattern":"RRtf"}],"h6s3":[function(require,module,exports) {
"use strict";var r=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(null!=r)for(var t in r)Object.hasOwnProperty.call(r,t)&&(i[t]=r[t]);return i.default=r,i};Object.defineProperty(exports,"__esModule",{value:!0});const i=r(require("./text")),t=require("./math"),o=require("./vector");class s{constructor(r){this.size=new o.Vector,this.size.set(r),this.charGrid=t.range(this.size.x).map(()=>t.range(this.size.y).map(()=>void 0)),this.colorGrid=t.range(this.size.x).map(()=>t.range(this.size.y).map(()=>void 0)),this.backgroundColorGrid=t.range(this.size.x).map(()=>t.range(this.size.y).map(()=>void 0)),this.rotationGrid=t.range(this.size.x).map(()=>t.range(this.size.y).map(()=>void 0)),this.symbolGrid=t.range(this.size.x).map(()=>t.range(this.size.y).map(()=>void 0))}print(r,t,o,s={}){let a=Math.floor(t),n=Math.floor(o);const e=a;let l=null!=s.colorPattern?s.colorPattern.split("\n"):void 0;const h=null!=s.backgroundColorPattern?s.backgroundColorPattern.split("\n"):void 0,d=null!=s.rotationPattern?s.rotationPattern.split("\n"):void 0,c=null!=s.symbolPattern?s.symbolPattern.split("\n"):void 0;let G=r;if(null!=s.charAndColorPattern){const[r,t]=i.getColorLines(s.charAndColorPattern);G=r.join("\n"),l=t}let u=0,m=0;for(let g=0;g<G.length;g++){const r=G[g];"\n"!==r?a<0||a>=this.size.x||n<0||n>=this.size.y?(a++,u++):(this.charGrid[a][n]=r,this.colorGrid[a][n]=null!=s.color?s.color:i.getCharFromLines(l,u,m),this.backgroundColorGrid[a][n]=null!=s.backgroundColor?s.backgroundColor:i.getCharFromLines(h,u,m),this.rotationGrid[a][n]=null!=s.rotation?s.rotation:i.getCharFromLines(d,u,m),this.symbolGrid[a][n]=null!=s.symbol?s.symbol:i.getCharFromLines(c,u,m),a++,u++):(a=e,n++,u=0,m++)}}getCharAt(r,t){if(r<0||r>=this.size.x||t<0||t>=this.size.y)return;const o=Math.floor(r),s=Math.floor(t),a=this.charGrid[o][s],n=this.colorGrid[o][s],e=this.backgroundColorGrid[o][s],l=this.rotationGrid[o][s],h=this.symbolGrid[o][s];return{char:a,options:i.getCharOption(n,e,l,h)}}setCharAt(r,t,o,s){if(r<0||r>=this.size.x||t<0||t>=this.size.y)return;const a=Math.floor(r),n=Math.floor(t);if(this.charGrid[a][n]=o,null!=s){if(this.colorGrid[a][n]=s.color,this.backgroundColorGrid[a][n]=s.backgroundColor,null==s.angleIndex)this.rotationGrid[a][n]=void 0;else{let r=s.angleIndex;s.isMirrorX&&(r|=4),s.isMirrorY&&(r|=8),this.rotationGrid[a][n]=i.rotationChars.charAt(r)}this.symbolGrid[a][n]=s.isSymbol?"s":void 0}else this.colorGrid[a][n]=this.backgroundColorGrid[a][n]=this.rotationGrid[a][n]=void 0}draw(){for(let r=0;r<this.size.x;r++)for(let t=0;t<this.size.y;t++){const o=this.charGrid[r][t];if(null==o)continue;const s=this.colorGrid[r][t],a=this.backgroundColorGrid[r][t],n=this.rotationGrid[r][t],e=this.symbolGrid[r][t];i.printChar(o,r*i.letterSize,t*i.letterSize,Object.assign(Object.assign({},i.getCharOption(s,a,n,e)),{scale:1,alpha:1}))}}clear(){for(let r=0;r<this.size.x;r++)for(let i=0;i<this.size.y;i++)this.charGrid[r][i]=this.colorGrid[r][i]=this.backgroundColorGrid[r][i]=this.rotationGrid[r][i]=this.symbolGrid[r][i]=void 0}scrollUp(){for(let i=0;i<this.size.x;i++)for(let r=1;r<this.size.y;r++)this.charGrid[i][r-1]=this.charGrid[i][r],this.colorGrid[i][r-1]=this.colorGrid[i][r],this.backgroundColorGrid[i][r-1]=this.backgroundColorGrid[i][r],this.rotationGrid[i][r-1]=this.rotationGrid[i][r],this.symbolGrid[i][r-1]=this.symbolGrid[i][r];const r=this.size.y-1;for(let i=0;i<this.size.x;i++)this.charGrid[i][r]=this.colorGrid[i][r]=this.backgroundColorGrid[i][r]=this.rotationGrid[i][r]=this.symbolGrid[i][r]=void 0}getState(){return{charGrid:this.charGrid.map(r=>[].concat(r)),colorGrid:this.colorGrid.map(r=>[].concat(r)),backgroundColorGrid:this.backgroundColorGrid.map(r=>[].concat(r)),rotationGrid:this.rotationGrid.map(r=>[].concat(r)),symbolGrid:this.symbolGrid.map(r=>[].concat(r))}}setState(r){this.charGrid=r.charGrid.map(r=>[].concat(r)),this.colorGrid=r.colorGrid.map(r=>[].concat(r)),this.backgroundColorGrid=r.backgroundColorGrid.map(r=>[].concat(r)),this.rotationGrid=r.rotationGrid.map(r=>[].concat(r)),this.symbolGrid=r.symbolGrid.map(r=>[].concat(r))}}exports.Terminal=s;
},{"./text":"souV","./math":"pR4u","./vector":"HIZ7"}],"InGM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.patterns=["\nwwwwwwww\nw   w dw\nw    c w\nw   w kw\nwwwwwwww\n"];
},{}],"qBxf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.patterns=["\n\n fff\n fff\n fff\n","\n\n wff\n fff\n fff\n","\n   ff\n wwff\n fff\n fff\n","\n\n www\n fff\n fff\n","\n\n www\n wff\n wff\n","\n  w\n wff\nffff\n ffw\n","\n\n wff\nffff\n wff\n","\n  f\n wff\nffff\n wfw\n  f\n","\n  f\n wfw\nfffff\n wfw\n  f\n","\n  f\n wfw\n wfff\n www\n","\n\n www\nfffff\n www\n","\n\n ffff\n fwff\n fff\n","\n\n www\n www\n www\n","\n\n www\n wff\nffff\nff\n","\n f f\n fff\n wfw\n fff\n f f\n","\n\n www\n www\n fff\n fff\n","\n\n www\nffwff\n fff\n ff\n"];
},{}],"iXZc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t=null){this.setSeed(t)}get(t=1,s){return null==s&&(s=t,t=0),this.next()/4294967295*(s-t)+t}getInt(t,s){return null==s&&(s=t,t=0),this.next()%(s-t)+t}getPlusOrMinus(){return 2*this.getInt(2)-1}select(t){return t[this.getInt(t.length)]}setSeed(t,s=123456789,e=362436069,h=521288629,i=32){this.w=null!=t?t>>>0:Math.floor(4294967295*Math.random())>>>0,this.x=s>>>0,this.y=e>>>0,this.z=h>>>0;for(let n=0;n<i;n++)this.next();return this}next(){const t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=(this.w^this.w>>>19^t^t>>>8)>>>0,this.w}}exports.Random=t;
},{}],"L0ny":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./templatePatterns"),r=require("./level"),t=require("./main"),o=require("../util/math"),s=require("../util/vector"),l=require("../util/random"),a=new l.Random;let n;function i(){n=e.patterns.map(e=>{const r=e.split("\n");return o.range(4).map(e=>o.range(5).map(t=>o.range(5).map(o=>y(r,t,o,e))))})}function c(e,t){a.setSeed(e),r.clearGrid();const{walls:o,floors:s,reachableFloors:l}=f(t);return p({walls:o,floors:s,reachableFloors:l}),h({reachableFloors:l})}function f(e){r.size.set(3*e.x+4,3*e.y+4),r.offset.set((t.terminalSize.x-r.size.x)/2,(t.terminalSize.y-r.size.y)/2).floor();const o=[],l=[];for(let t=0;t<e.x;t++)for(let o=0;o<e.y;o++){const e=n[a.getInt(n.length)][a.getInt(4)];for(let s=0;s<5;s++)for(let l=0;l<5;l++){const a=e[s][l];"empty"!==a&&(r.grid[r.offset.x+1+3*t+s][r.offset.y+1+3*o+l]=a)}}for(let a=0;a<t.terminalSize.x;a++)for(let e=0;e<t.terminalSize.y;e++){const t=r.grid[a][e];"floor"===t?o.push(new s.Vector(a,e)):"wall"===t&&l.push(new s.Vector(a,e))}r.setKeeper(a.select(o),0),r.grid[r.keeperPos.x][r.keeperPos.y]="floor reachable";for(let t=0;t<99;t++)o.forEach(e=>{[[1,0],[-1,0],[0,1],[0,-1]].forEach(t=>{"floor reachable"===r.grid[e.x+t[0]][e.y+t[1]]&&(r.grid[e.x][e.y]="floor reachable")})});const i=o.filter(e=>"floor reachable"===r.grid[e.x][e.y]);return{walls:l,floors:o,reachableFloors:i}}function p({walls:e,floors:t,reachableFloors:o}){o.forEach(t=>{for(let o=-1;o<=1;o++)for(let l=-1;l<=1;l++){const a=new s.Vector(t).add(o,l);"empty"!==r.grid[a.x][a.y]&&"floor"!==r.grid[a.x][a.y]||(r.grid[a.x][a.y]="wall",e.push(a))}});for(let s=0;s<9;s++)e.forEach(e=>{let t=!0;for(let o=-1;o<=1;o++)for(let s=-1;s<=1;s++)"floor reachable"===r.grid[e.x+o][e.y+s]&&(t=!1);t&&(r.grid[e.x][e.y]="empty")});t.forEach(e=>{r.grid[e.x][e.y]="empty"})}function h({reachableFloors:e}){let t,o=e.filter(e=>e.x!==r.keeperPos.x||e.y!==r.keeperPos.y),l=Math.floor(.3*o.length)+1;const n=[];for(;l>0;){a.get()<.01&&(t=void 0);const e=a.getInt(o.length),s=o[e];null!=t&&Math.abs(t.x-s.x)+Math.abs(t.y-s.y)!==1||(r.grid[s.x][s.y]="crate on dot",n.push({pos:s,isMoved:!1}),t=s,o.splice(e,1),l--)}let i,c;const f=new s.Vector,p=new s.Vector;for(let s=0;s<32;s++){for(let t=0;t<64;t++){const t=a.select(n),o=a.select(e);if(t.pos.equals(o))continue;const s=r.getPath(t.pos,o,"pull");if(null!=s){i=t,f.set(t.pos),p.set(r.keeperPos),c=t.isMoved,r.removeCrate(t.pos),t.pos.set(o),t.isMoved=!0;const e=r.angleOffsets[s[s.length-1]];r.keeperPos.set(t.pos.x+e.x,t.pos.y+e.y),r.setCrate(t.pos)}}null!=i&&(r.removeCrate(i.pos),r.setCrate(f),r.keeperPos.set(p),i.pos.set(f),i.isMoved=c,i=void 0);for(let e=0;e<n.length;e++){const t=n[e];if(!t.isMoved){r.grid[t.pos.x][t.pos.y]="empty",n.splice(e,1);break}}if(0===n.length)break}let h=0;return n.forEach(e=>{e.isMoved?h++:r.grid[e.pos.x][e.pos.y]="empty"}),h}function y(e,t,o,s){let l,a;switch(s){case 0:l=t,a=o;break;case 1:l=o,a=4-t;break;case 2:l=4-t,a=4-o;break;case 3:l=4-o,a=t}if(a>e.length)return"empty";const n=e[a+1];return l>=n.length?"empty":r.charToType[n.charAt(l)]}exports.init=i,exports.generate=c;
},{"./templatePatterns":"qBxf","./level":"IHdg","./main":"ZCfc","../util/math":"pR4u","../util/vector":"HIZ7","../util/random":"iXZc"}],"IHdg":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./main"),r=require("../util/terminal"),o=require("./levelsPattern"),s=e(require("./generator")),x=require("../util/vector"),p=require("../util/math");exports.angleOffsets=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}],exports.keeperPos=new x.Vector,exports.keeperAngle=0,exports.size=new x.Vector,exports.offset=new x.Vector,exports.charToType={" ":"empty",k:"empty",f:"floor",w:"wall",d:"dot",K:"dot",c:"crate",C:"crate on dot"};const n={empty:" ",wall:"E",dot:"F",crate:"C","crate on dot":"D"};let f;function i(){exports.terminal=new r.Terminal(t.terminalSize),s.init(),exports.grid=p.range(t.terminalSize.x).map(()=>p.range(t.terminalSize.y).map(()=>"empty")),f=p.range(t.terminalSize.x).map(()=>p.range(t.terminalSize.y).map(()=>!1))}function l(e){const r=o.patterns[e].split("\n").slice(1,-1);exports.size.set(0,r.length),r.forEach(e=>{exports.size.x=Math.max(e.length,exports.size.x)}),exports.offset.set((t.terminalSize.x-exports.size.x)/2,(t.terminalSize.y-exports.size.y)/2).floor(),r.forEach((e,t)=>{e.split("").map((e,r)=>{"k"!==e&&"K"!==e||exports.keeperPos.set(r+exports.offset.x,t+exports.offset.y),exports.grid[r+exports.offset.x][t+exports.offset.y]=exports.charToType[e]})})}function a(){for(let e=0;e<t.terminalSize.x;e++)for(let r=0;r<t.terminalSize.y;r++)exports.grid[e][r]="empty",f[e][r]=!1}function c(){exports.terminal.clear();for(let r=exports.offset.y;r<exports.offset.y+exports.size.y;r++)for(let e=exports.offset.x;e<exports.offset.x+exports.size.x;e++)exports.terminal.print(n[exports.grid[e][r]],e,r,{symbol:"s"});const e=exports.keeperAngle%2==0?"A":"B",t=["k","k","n","o"][exports.keeperAngle];exports.terminal.print(e,exports.keeperPos.x,exports.keeperPos.y,{symbol:"s",rotation:t})}function y(e,t,r){if(!t.isInRect(exports.offset.x+1,exports.offset.y+1,exports.size.x-2,exports.size.y-2)||e.equals(t))return;const o=new x.Vector(exports.keeperPos),s=u(e,r);z(e);let p,n=[{path:[],pos:e,angles:s}],f={};f[w({pos:e,angles:s})]=!0;for(let x=0;x<99;x++){const s=n.shift();if(s.angles.forEach(e=>{const o=exports.angleOffsets[e],x={x:s.pos.x+o.x,y:s.pos.y+o.y},i=s.path.concat([e]);if(x.x===t.x&&x.y===t.y)return void(p=i);k(x),"push"===r?exports.keeperPos.set(s.pos):exports.keeperPos.set(x.x+o.x,x.y+o.y);const l=u(x,r);z(x);const a=w({pos:x,angles:l});l.length>0&&!f[a]&&(n.push({path:i,pos:x,angles:l}),f[a]=!0)}),null!=p||0===n.length)return k(e),exports.keeperPos.set(o),p}k(e),exports.keeperPos.set(o)}function u(e,t){let r;if("push"===t){const t=m(e.x-1,e.y)||m(e.x+1,e.y),o=m(e.x,e.y-1)||m(e.x,e.y+1);if(0===(r=t?o?[]:[1,3]:o?[0,2]:[0,1,2,3]).length)return r}else r=[0,1,2,3];for(let o=exports.offset.y+1;o<exports.offset.y+exports.size.y-1;o++)for(let e=exports.offset.x+1;e<exports.offset.x+exports.size.x-1;e++)f[e][o]=!1;f[exports.keeperPos.x][exports.keeperPos.y]=!0;for(let o=0;o<9;o++){if(0===g()+d())break}return r=r.filter(r=>{const o=exports.angleOffsets[r];return"push"===t?f[e.x-o.x][e.y-o.y]:f[e.x+o.x][e.y+o.y]&&f[e.x+2*o.x][e.y+2*o.y]})}function g(){let e=0;for(let t=exports.offset.y+1;t<exports.offset.y+exports.size.y-1;t++)for(let r=exports.offset.x+1;r<exports.offset.x+exports.size.x-1;r++)f[r][t]||m(r,t)||!h(r,t-1)&&!h(r-1,t)||(f[r][t]=!0,e++);return e}function d(){let e=0;for(let t=exports.offset.y+exports.size.y-2;t>exports.offset.y;t--)for(let r=exports.offset.x+exports.size.x-2;r>exports.offset.x;r--)f[r][t]||m(r,t)||!h(r+1,t)&&!h(r,t+1)||(f[r][t]=!0,e++);return e}function m(e,t){return"wall"===exports.grid[e][t]||"crate"===exports.grid[e][t]||"crate on dot"===exports.grid[e][t]}function h(e,t){return("empty"===exports.grid[e][t]||"dot"===exports.grid[e][t])&&f[e][t]}function z(e){const t=exports.grid[e.x][e.y];"crate"!==t&&"crate on dot"!==t&&console.error("no crate"),exports.grid[e.x][e.y]="crate on dot"===t?"dot":"empty"}function k(e){const t=exports.grid[e.x][e.y];"crate"!==t&&"crate on dot"!==t||console.error("crate"),exports.grid[e.x][e.y]="dot"===t?"crate on dot":"crate"}function P(e,t){exports.keeperPos.set(e),exports.keeperAngle=t}function S(){let e=0;for(let t=exports.offset.y;t<exports.offset.y+exports.size.y;t++)for(let r=exports.offset.x;r<exports.offset.x+exports.size.x;r++)"crate"===exports.grid[r][t]&&e++;return 0===e}function w(e){const t=JSON.stringify(e);let r=0;for(let o=0;o<t.length;o++){r=(r<<5)-r+t.charCodeAt(o),r|=0}return r}exports.init=i,exports.setFromPatterns=l,exports.clearGrid=a,exports.draw=c,exports.getPath=y,exports.getMovableAngles=u,exports.removeCrate=z,exports.setCrate=k,exports.setKeeper=P,exports.checkSolved=S;
},{"./main":"ZCfc","../util/terminal":"h6s3","./levelsPattern":"InGM","./generator":"L0ny","../util/vector":"HIZ7","../util/math":"pR4u"}],"WJcb":[function(require,module,exports) {
"use strict";var n=this&&this.__importStar||function(n){if(n&&n.__esModule)return n;var l={};if(null!=n)for(var r in n)Object.hasOwnProperty.call(n,r)&&(l[r]=n[r]);return l.default=n,l};Object.defineProperty(exports,"__esModule",{value:!0});const l=n(require("../util/text")),r=["\n   rr\n   rr\n  cccc \n  yy\n y  y\ny    y\n","\ny    y\n y  y\n  yy\n  cc\n crrc\nc rr c\n","\n cppc\nccppcc\npppppp\npppppp\nccppcc\n cppc\n","\n bppb\nbbppbb\npppppp\npppppp\nbbppbb\n bppb\n","\nbrrbrr\nbbbbrr\nbrrbrr\nbrrbrr\nbrrbbb\nbrrbrr\n","\n rr\nrrrr\nrrrr\n rr\n","\nyyyyyy\ny    y\ny    y\ny    y\ny    y\nyyyyyy\n","\ngggggg\ng    g\ng    g\ng    g\ng    g\ngggggg\n","\nr    r\n r  r\n  rr\n  rr\n r  r\nr    r\n","\nl\n     l\nl \n     l\nl\n     l\n","\nll\n    ll\nll\n    ll\nll\n    ll\n","\nlll\n   lll\nlll\n   lll\nlll\n   lll\n","\nllll\n  llll\nllll\n  llll\nllll\n  llll\n","\nlllll\n lllll\nlllll\n lllll\nlllll\n lllll\n"];function p(){l.defineSymbols(r,"A")}exports.init=p;
},{"../util/text":"souV"}],"iUdv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./vector"),s=require("./random"),t=require("./math");exports.pos=new e.Vector,exports.move=new e.Vector,exports.pressedPos=new e.Vector,exports.targetPos=new e.Vector,exports.isPressed=!1,exports.isJustPressed=!1,exports.isJustReleased=!1;let o,r,n,p={isDebugMode:!1,anchor:new e.Vector,padding:new e.Vector,onPointerDownOrUp:void 0};const d=new e.Vector,x=new s.Random,i=new e.Vector,a=new e.Vector;let u=!1,c=new e.Vector(-9999,-9999),P=!1,g=!1,y=!1,l=!1;function f(s,t,d){n=Object.assign(Object.assign({},p),d),o=s,r=new e.Vector(t.x+2*n.padding.x,t.y+2*n.padding.y),exports.targetPos.set(r.x/2,r.y/2),n.isDebugMode&&i.set(r.x/2,r.y/2),document.addEventListener("mousedown",e=>{J(e.pageX,e.pageY)}),document.addEventListener("touchstart",e=>{J(e.touches[0].pageX,e.touches[0].pageY)}),document.addEventListener("mousemove",e=>{O(e.pageX,e.pageY)}),document.addEventListener("touchmove",e=>{e.preventDefault(),O(e.touches[0].pageX,e.touches[0].pageY)},{passive:!1}),document.addEventListener("mouseup",e=>{L(e)}),document.addEventListener("touchend",e=>{e.preventDefault(),e.target.click(),L(e)},{passive:!1})}function v(){V(c.x,c.y,exports.pos),n.isDebugMode&&!exports.pos.isInRect(0,0,r.x,r.y)?(D(),exports.pos.set(i),exports.isJustPressed=!exports.isPressed&&u,exports.isJustReleased=exports.isPressed&&!u,exports.isPressed=u):(exports.isJustPressed=!exports.isPressed&&g,exports.isJustReleased=exports.isPressed&&y,exports.isPressed=P),exports.isJustPressed&&(exports.pressedPos.set(exports.pos),d.set(exports.pos)),exports.move.set(exports.pos.x-d.x,exports.pos.y-d.y),d.set(exports.pos),l?exports.targetPos.set(exports.pos):exports.targetPos.add(exports.move),g=y=!1}function w(){exports.isJustPressed=!1,exports.isPressed=!0}function m(e=1){exports.pressedPos.x+=(exports.pos.x-exports.pressedPos.x)*e,exports.pressedPos.y+=(exports.pos.y-exports.pressedPos.y)*e}function h(e){exports.targetPos.set(e)}function V(e,s,t){null!=o&&(t.x=((e-o.offsetLeft)/o.clientWidth+n.anchor.x)*r.x-n.padding.x,t.y=((s-o.offsetTop)/o.clientHeight+n.anchor.y)*r.y-n.padding.y)}function D(){a.length>0?(i.add(a),!t.isInRange(i.x,.1*-r.x,1.1*r.x)&&i.x*a.x>0&&(a.x*=-1),!t.isInRange(i.y,.1*-r.y,1.1*r.y)&&i.y*a.y>0&&(a.y*=-1),x.get()<.05&&a.set(0)):x.get()<.1&&(a.set(0),a.addAngle(x.get(2*Math.PI),(r.x+r.y)*x.get(.01,.03))),x.get()<.05&&(u=!u)}function J(e,s){c.set(e,s),P=g=!0,l=!1,null!=n.onPointerDownOrUp&&n.onPointerDownOrUp()}function O(e,s){c.set(e,s),P||(l=!0)}function L(e){P=!1,y=!0,l=!1,null!=n.onPointerDownOrUp&&n.onPointerDownOrUp()}exports.init=f,exports.update=v,exports.clearJustPressed=w,exports.resetPressedPointerPos=m,exports.setTargetPos=h;
},{"./vector":"HIZ7","./random":"iXZc","./math":"pR4u"}],"zONe":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(s[t]=e[t]);return s.default=e,s};Object.defineProperty(exports,"__esModule",{value:!0});const s=e(require("../util/pointer")),t=e(require("../util/view")),r=e(require("../util/text")),i=require("../util/vector"),o=new i.Vector(31,7);function n({pos:e,text:s,onClick:t}){return{pos:e,text:s,onClick:t,isPressed:!1}}function u(e){const n=new i.Vector(s.pos).sub(e.pos).isInRect(0,0,o.x,o.y);s.isJustPressed&&n&&(e.isPressed=!0),e.isPressed&&!n&&(e.isPressed=!1),e.isPressed&&s.isJustReleased&&(e.onClick(),e.isPressed=!1);const u=r.rgbObjects[e.isPressed?5:12];t.context.fillStyle=`rgb(${u.r},${u.g},${u.b})`,t.context.fillRect(e.pos.x,e.pos.y,o.x,o.y),r.print(e.text,e.pos.x,e.pos.y,{color:n?"w":"W"})}exports.get=n,exports.update=u;
},{"../util/pointer":"iUdv","../util/view":"YCKg","../util/text":"souV","../util/vector":"HIZ7"}],"kmeV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const s=require("./vector"),e=require("./math");exports.isPressed=!1,exports.isJustPressed=!1,exports.isJustReleased=!1,exports.stick=new s.Vector,exports.isStickPressed=e.range(4).map(()=>!1),exports.isStickJustPressed=e.range(4).map(()=>!1),exports.isStickJustReleased=e.range(4).map(()=>!1);const t={isUsingStickKeysAsButton:!1,isFourWaysStick:!1,onKeyDown:void 0};let r;const o=e.range(256).map(()=>!1),i=e.range(256).map(()=>!1),n=e.range(256).map(()=>!1),c=[[39,68,102],[40,83,101,98],[37,65,100],[38,87,104]],p=[[1,0],[0,1],[-1,0],[0,-1]],d=[90,88,67,86,66,78,77,188,190,191,17,16,18,32,13];function x(s){r=Object.assign(Object.assign({},t),s),document.addEventListener("keydown",s=>{o[s.keyCode]=i[s.keyCode]=!0,null!=r.onKeyDown&&r.onKeyDown()}),document.addEventListener("keyup",s=>{o[s.keyCode]=!1,n[s.keyCode]=!0})}function a(){const s=exports.isPressed;exports.isPressed=exports.isJustPressed=exports.isJustReleased=!1,e.range(4).forEach(s=>{exports.isStickPressed[s]=exports.isStickJustPressed[s]=exports.isStickJustReleased[s]=!1}),exports.stick.set(0),c.forEach((e,t)=>{e.forEach(e=>{(o[e]||i[e])&&(exports.stick.x+=p[t][0],exports.stick.y+=p[t][1],exports.isStickPressed[t]=!0,r.isUsingStickKeysAsButton&&(exports.isPressed=!0),i[e]&&(i[e]=!1,exports.isStickJustPressed[t]=!0,r.isUsingStickKeysAsButton&&!s&&(exports.isJustPressed=!0))),n[e]&&(n[e]=!1,exports.isStickJustReleased[t]=!0,r.isUsingStickKeysAsButton&&s&&(exports.isJustReleased=!0))})}),exports.stickAngle=-1,exports.stick.length>0&&k(exports.stick.getAngle()),d.forEach(e=>{o[e]&&(exports.isPressed=!0),i[e]&&(i[e]=!1,s||(exports.isPressed=exports.isJustPressed=!0)),n[e]&&(n[e]=!1,s&&(exports.isJustReleased=!0))})}exports.init=x,exports.update=a;const u=[1,0,1,1,0,1,-1,1,-1,0,-1,-1,0,-1,1,-1];function k(s){const t=r.isFourWaysStick?Math.PI/2:Math.PI/4,o=r.isFourWaysStick?2:1;exports.stickAngle=e.wrap(Math.round(s/t)*o,0,8),exports.stick.set(u[2*exports.stickAngle],u[2*exports.stickAngle+1])}function P(){exports.isJustPressed=!1,exports.isPressed=!0}exports.clearJustPressed=P;
},{"./vector":"HIZ7","./math":"pR4u"}],"o5Dp":[function(require,module,exports) {
var define;
var e;!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof e&&e.amd?e([],n):"object"==typeof exports?exports.sss=n():t.sss=n()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){var n;!function(e){"use strict";String.fromCharCode;var t=2*+Math.PI,n=16,r=1,a=Math.sin,o=Math.pow,i=Math.abs;e.SampleRate=0,e.Sec=0,e.SetSampleRate=function(t){e.SampleRate=0|t,e.Sec=0|t},e.SetSampleRate(void 0!==u?(new u).sampleRate:44100),e.Sound=function(t){var n=new h(t,e.DefaultModules),r=b(n.getSamplesLeft());return n.generate(r),g(r)},e.Sounds=function(t,n,r){var a={},o={};o._audio=a;var i=[];P(t,function(e,t){o[t]=function(){void 0!==a[t]&&(a[t].currentTime=0,a[t].play())},i.push(t)});var u=0,l=i.length;return function o(){if(0!=i.length){var s=i.shift();a[s]=e.Sound(t[s]),r&&r(s,++u,l),window.setTimeout(o,30)}else n&&n(sounds)}(),o},e.SoundsImmediate=function(t){var n={},r={};return r._audio=n,P(t,function(t,a){n[a]=e.Sound(t),r[a]=function(){void 0!==n[a]&&(n[a].currentTime=0,n[a].play())}}),r};var u=window.AudioContext||window.webkitAudioContext;void 0!==u?(e.Node=function(t,n,r,a,o){var i=t.createScriptProcessor(a,0,1),u=new h(n,r||e.DefaultModules);return i.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0);u.generate(t),!o&&u.finished&&setTimeout(function(){i.disconnect()},30)},i},e.Live=function(t,n,r){r=r||2048;var a={},o=new u,i=o.createGain();function l(e,t){var n=o.createBufferSource();if(n.buffer=e,null!=t&&null!=n.playbackRate){const e=Math.pow(2,1/12);n.playbackRate.value=Math.pow(e,t/100)}return n.start=n.start||n.noteOn,n}return i.connect(o.destination),a._context=o,a._volume=i,P(t,function(t,u){a[u]=function(){e.Node(o,t,n,r).connect(i)}}),a._close=function(){o.close()},a._play=function(t){e.Node(o,t,n,r).connect(i)},a._createBuffer=function(t){var n=new h(t,e.DefaultModules),r=b(n.getSamplesLeft());return n.generate(r),a._createBufferFromBlock(r)},a._createEmptyBuffer=function(){return a._createBufferFromBlock([0])},a._createBufferFromBlock=function(t){var n=o.createBuffer(1,t.length,e.SampleRate);return n.getChannelData(0).set(t),n},a._playBuffer=function(e,t,n){var r=l(e,n);r.connect(i),r.start(t)},a._playBufferAndConnect=function(e,t,n,r){var a=l(e,r);a.connect(n),n.connect(i),a.start(t)},a._createGain=function(){return o.createGain()},a}):e.Live=function(e,t,n){return null},e.Module={},e.G={};var l=e.stage={PhaseSpeed:0,PhaseSpeedMod:10,Generator:20,SampleMod:30,Volume:40};function s(e,t){return e.stage-t.stage}function c(e,t){for(var n=0;n<t.length;n+=1){var r=t[n],a=e[r.name]||{};P(r.params,function(e,t){void 0===a[t]&&(a[t]=e.D)}),e[r.name]=a}}function h(t,n){t=t||{},n=n||e.DefaultModules,t="function"==typeof t?t():JSON.parse(JSON.stringify(t)),this.finished=!1,this.state={SampleRate:t.SampleRate||e.SampleRate},(n=n.slice()).sort(s),this.modules=n,c(t,n);for(var r=0;r<this.modules.length;r+=1){var a=this.modules[r];this.modules[r].setup(this.state,t[a.name])}}function f(){return P(e.Module,function(){return{}})}function p(e){for(var t in e)0==F(e[t]).length&&delete e[t]}function d(e){return new Function("$","block","var TAU = Math.PI * 2;\nvar sample;\nvar phase = +$.generatorPhase,\n\tA = +$.generatorA, ASlide = +$.generatorASlide,\n\tB = +$.generatorB, BSlide = +$.generatorBSlide;\n\nfor(var i = 0; i < block.length; i++){\n\tvar phaseSpeed = block[i];\n\tphase += phaseSpeed;\n\tif(phase > TAU){ phase -= TAU };\n\tA += ASlide; B += BSlide;\n   A = A < 0 ? 0 : A > 1 ? 1 : A;\n   B = B < 0 ? 0 : B > 1 ? 1 : B;\n"+e+"\tblock[i] = sample;\n}\n\n$.generatorPhase = phase;\n$.generatorA = A;\n$.generatorB = B;\nreturn block.length;\n")}function g(t){"undefined"!=typeof Float32Array&&S(t instanceof Float32Array,"data must be an Float32Array");var a=r*n>>3,o=e.SampleRate*a,i=function(e){if("undefined"==typeof Uint8Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Uint8Array(e)}(44+2*t.length),u=0;function l(e){for(var t=0;t<e.length;t+=1)i[u]=e.charCodeAt(t),u++}function s(e,t){t<=0||(i[u]=255&e,u++,s(e>>8,t-1))}return l("RIFF"),s(36+2*t.length,4),l("WAVEfmt "),s(16,4),s(1,2),s(r,2),s(e.SampleRate,4),s(o,4),s(a,2),s(n,2),l("data"),s(2*t.length,4),m(i.subarray(u),t),new Audio("data:audio/wav;base64,"+function(e){for(var t="",n=0;n<e.length;n+=32768){var r=Math.min(n+32768,e.length);t+=String.fromCharCode.apply(null,e.subarray(n,r))}return btoa(t)}(i))}function m(e,t){S(e.length/2==t.length,"the target buffer must be twice as large as the iinput");for(var n=0,r=0;r<t.length;r++){var a=32767*+t[r]|0;a=a<-32768?-32768:32767<a?32767:a,a+=a<0?65536:0,e[n]=255&a,e[++n]=a>>8,n++}}function S(e,t){if(!e)throw new Error(t)}function y(e,t,n){return n=+n,(e=+e)<(t=+t)?+t:e>n?+n:+e}function v(e){return(e=+e)<0?0:e>1?1:+e}function P(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function M(e,t){var n=D();return void 0!==e&&(n*=e),void 0!==t&&(n+=t),n}function L(e){return e[e.length*D()|0]}function F(e){var t=[];for(var n in e)t.push(n);return t}function b(e){if("undefined"==typeof Float32Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Float32Array(e)}e.InitDefaultParams=c,e.Processor=h,h.prototype={generate:function(e){for(var t=0;t<e.length;t+=1)e[t]=0;if(!this.finished){var n=this.state,r=0|e.length;for(t=0;t<this.modules.length;t+=1){var a=0|this.modules[t].process(n,e.subarray(0,r));r=Math.min(r,a)}for(r<e.length&&(this.finished=!0),t=r;t<e.length;t++)e[t]=0}},getSamplesLeft:function(){for(var e=0,t=0;t<this.state.envelopes.length;t+=1)e+=this.state.envelopes[t].N;return 0===e&&(e=3*this.state.SampleRate),e}},e.Module.Frequency={name:"Frequency",params:{Start:{L:30,H:1800,D:440},Min:{L:30,H:1800,D:30},Max:{L:30,H:1800,D:1800},Slide:{L:-1,H:1,D:0},DeltaSlide:{L:-1,H:1,D:0},RepeatSpeed:{L:0,H:3,D:0},ChangeAmount:{L:-12,H:12,D:0},ChangeSpeed:{L:0,H:1,D:0}},stage:l.PhaseSpeed,setup:function(e,n){var r=e.SampleRate;e.phaseParams=n,e.phaseSpeed=n.Start*t/r,e.phaseSpeedMax=n.Max*t/r,e.phaseSpeedMin=n.Min*t/r,e.phaseSpeedMin=Math.min(e.phaseSpeedMin,e.phaseSpeed),e.phaseSpeedMax=Math.max(e.phaseSpeedMax,e.phaseSpeed),e.phaseSlide=1+64*o(n.Slide,3)/r,e.phaseDeltaSlide=o(n.DeltaSlide,3)/(1e3*r),e.repeatTime=0,e.repeatLimit=1/0,n.RepeatSpeed>0&&(e.repeatLimit=n.RepeatSpeed*r),e.arpeggiatorTime=0,e.arpeggiatorLimit=n.ChangeSpeed*r,0==n.ChangeAmount&&(e.arpeggiatorLimit=1/0),e.arpeggiatorMod=1+n.ChangeAmount/12},process:function(e,t){for(var n=+e.phaseSpeed,r=+e.phaseSpeedMin,a=+e.phaseSpeedMax,o=+e.phaseSlide,i=+e.phaseDeltaSlide,u=e.repeatTime,l=e.repeatLimit,s=e.arpeggiatorTime,c=e.arpeggiatorLimit,h=e.arpeggiatorMod,f=0;f<t.length;f++){if(n=(n*=o+=i)<r?r:n>a?a:n,u>l)return this.setup(e,e.phaseParams),f+this.process(e,t.subarray(f))-1;u++,s>c&&(n*=h,s=0,c=1/0),s++,t[f]+=n}return e.repeatTime=u,e.arpeggiatorTime=s,e.arpeggiatorLimit=c,e.phaseSpeed=n,e.phaseSlide=o,t.length}},e.Module.Vibrato={name:"Vibrato",params:{Depth:{L:0,H:1,D:0},DepthSlide:{L:-1,H:1,D:0},Frequency:{L:.01,H:48,D:0},FrequencySlide:{L:-1,H:1,D:0}},stage:l.PhaseSpeedMod,setup:function(e,n){var r=e.SampleRate;e.vibratoPhase=0,e.vibratoDepth=n.Depth,e.vibratoPhaseSpeed=n.Frequency*t/r,e.vibratoPhaseSpeedSlide=1+3*o(n.FrequencySlide,3)/r,e.vibratoDepthSlide=n.DepthSlide/r},process:function(e,n){var r=+e.vibratoPhase,o=+e.vibratoDepth,i=+e.vibratoPhaseSpeed,u=+e.vibratoPhaseSpeedSlide,l=+e.vibratoDepthSlide;if(0==o&&l<=0)return n.length;for(var s=0;s<n.length;s++)(r+=i)>t&&(r-=t),n[s]+=n[s]*a(r)*o,i*=u,o=v(o+=l);return e.vibratoPhase=r,e.vibratoDepth=o,e.vibratoPhaseSpeed=i,n.length}},e.Module.Generator={name:"Generator",params:{Func:{C:e.G,D:"square"},A:{L:0,H:1,D:0},B:{L:0,H:1,D:0},ASlide:{L:-1,H:1,D:0},BSlide:{L:-1,H:1,D:0}},stage:l.Generator,setup:function(t,n){t.generatorPhase=0,"string"==typeof n.Func?t.generator=e.G[n.Func]:t.generator=n.Func,"object"==typeof t.generator&&(t.generator=t.generator.create()),S("function"==typeof t.generator,"generator must be a function"),t.generatorA=n.A,t.generatorASlide=n.ASlide,t.generatorB=n.B,t.generatorBSlide=n.BSlide},process:function(e,t){return e.generator(e,t)}},e.Module.Guitar={name:"Guitar",params:{A:{L:0,H:1,D:1},B:{L:0,H:1,D:1},C:{L:0,H:1,D:1}},stage:l.Generator,setup:function(e,t){e.guitarA=t.A,e.guitarB=t.B,e.guitarC=t.C,e.guitarBuffer=b(65536),e.guitarHead=0;for(var n=e.guitarBuffer,r=0;r<n.length;r++)n[r]=2*D()-1},process:function(e,n){for(var r=65536,a=r-1,o=+e.guitarA,i=+e.guitarB,u=+e.guitarC,l=o+i+u,s=e.guitarHead,c=e.guitarBuffer,h=0;h<n.length;h++){var f=t/n[h]|0,p=s-(f=f>r?r:f)+r&a;c[s]=(c[p-0+r&a]*o+c[p-1+r&a]*i+c[p-2+r&a]*u)/l,n[h]=c[s],s=s+1&a}return e.guitarHead=s,n.length}},e.Module.Filter={name:"Filter",params:{LP:{L:0,H:1,D:1},LPSlide:{L:-1,H:1,D:0},LPResonance:{L:0,H:1,D:0},HP:{L:0,H:1,D:0},HPSlide:{L:-1,H:1,D:0}},stage:l.SampleMod+0,setup:function(e,t){e.FilterEnabled=t.HP>1e-6||t.LP<1-1e-6,e.LPEnabled=t.LP<1-1e-6,e.LP=o(t.LP,3)/10,e.LPSlide=1+100*t.LPSlide/e.SampleRate,e.LPPos=0,e.LPPosSlide=0,e.LPDamping=5/(1+20*o(t.LPResonance,2))*(.01+t.LP),e.LPDamping=1-Math.min(e.LPDamping,.8),e.HP=o(t.HP,2)/10,e.HPPos=0,e.HPSlide=1+100*t.HPSlide/e.SampleRate},enabled:function(e){return e.FilterEnabled},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=+e.LP,r=+e.LPPos,a=+e.LPPosSlide,o=+e.LPSlide,i=+e.LPDamping,u=+e.LPEnabled,l=+e.HP,s=+e.HPPos,c=+e.HPSlide,h=0;h<t.length;h++){(l>1e-6||l<-1e-6)&&(l=(l*=c)<1e-6?1e-6:l>.1?.1:l);var f=r;n=(n*=o)<0?n=0:n>.1?.1:n;var p=t[h];u?(a+=(p-r)*n,a*=i):(r=p,a=0),s+=(r+=a)-f,s*=1-l,t[h]=s}return e.LPPos=r,e.LPPosSlide=a,e.LP=n,e.HP=l,e.HPPos=s,t.length}},e.Module.Phaser={name:"Phaser",params:{Offset:{L:-1,H:1,D:0},Sweep:{L:-1,H:1,D:0}},stage:l.SampleMod+1,setup:function(e,t){e.phaserBuffer=b(1024),e.phaserPos=0,e.phaserOffset=1020*o(t.Offset,2),e.phaserOffsetSlide=4e3*o(t.Sweep,3)/e.SampleRate},enabled:function(e){return i(e.phaserOffsetSlide)>1e-6||i(e.phaserOffset)>1e-6},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=e.phaserBuffer,r=0|e.phaserPos,a=+e.phaserOffset,o=+e.phaserOffsetSlide,i=0;i<t.length;i++){(a+=o)<0&&(a=-a,o=-o),a>1023&&(a=1023,o=0),n[r]=t[i];var u=r-(0|a)+1024&1023;t[i]+=n[u],r=r+1&1023|0}return e.phaserPos=r,e.phaserOffset=a,t.length}},e.Module.Volume={name:"Volume",params:{Master:{L:0,H:1,D:.5},Attack:{L:.001,H:1,D:.01},Sustain:{L:0,H:2,D:.3},Punch:{L:0,H:3,D:1},Decay:{L:.001,H:2,D:1}},stage:l.Volume,setup:function(e,t){var n=e.SampleRate,r=t.Master,a=r*(1+t.Punch);e.envelopes=[{S:0,E:r,N:t.Attack*n|0},{S:a,E:r,N:t.Sustain*n|0},{S:r,E:0,N:t.Decay*n|0}];for(var o=0;o<e.envelopes.length;o+=1){var i=e.envelopes[o];i.G=(i.E-i.S)/i.N}},process:function(e,t){for(var n=0;e.envelopes.length>0&&n<t.length;){for(var r=e.envelopes[0],a=r.S,o=r.G,i=0|Math.min(t.length-n,r.N),u=n+i|0;n<u;n+=1)t[n]*=a,a=y(a+=o,0,10);r.S=a,r.N-=i,r.N<=0&&e.envelopes.shift()}return n}},e.DefaultModules=[e.Module.Frequency,e.Module.Vibrato,e.Module.Generator,e.Module.Filter,e.Module.Phaser,e.Module.Volume],e.DefaultModules.sort(s),e.EmptyParams=f,e._RemoveEmptyParams=p,e.Preset={Reset:function(){return f()},Coin:function(){var e=f();return e.Frequency.Start=M(880,660),e.Volume.Sustain=M(.1),e.Volume.Decay=M(.4,.1),e.Volume.Punch=M(.3,.3),M()<.5&&(e.Frequency.ChangeSpeed=M(.15,.1),e.Frequency.ChangeAmount=M(8,4)),p(e),e},Laser:function(){var e=f();return e.Generator.Func=L(["square","saw","sine"]),M()<.33?(e.Frequency.Start=M(880,440),e.Frequency.Min=M(.1),e.Frequency.Slide=M(.3,-.8)):(e.Frequency.Start=M(1200,440),e.Frequency.Min=e.Frequency.Start-M(880,440),e.Frequency.Min<110&&(e.Frequency.Min=110),e.Frequency.Slide=M(.3,-1)),M()<.5?(e.Generator.A=M(.5),e.Generator.ASlide=M(.2)):(e.Generator.A=M(.5,.4),e.Generator.ASlide=M(.7)),e.Volume.Sustain=M(.2,.1),e.Volume.Decay=M(.4),M()<.5&&(e.Volume.Punch=M(.3)),M()<.33&&(e.Phaser.Offset=M(.2),e.Phaser.Sweep=M(.2)),M()<.5&&(e.Filter.HP=M(.3)),p(e),e},Explosion:function(){var e=f();return e.Generator.Func="noise",M()<.5?(e.Frequency.Start=M(440,40),e.Frequency.Slide=M(.4,-.1)):(e.Frequency.Start=M(1600,220),e.Frequency.Slide=M(-.2,-.2)),M()<.2&&(e.Frequency.Slide=0),M()<.3&&(e.Frequency.RepeatSpeed=M(.5,.3)),e.Volume.Sustain=M(.3,.1),e.Volume.Decay=M(.5),e.Volume.Punch=M(.6,.2),M()<.5&&(e.Phaser.Offset=M(.9,-.3),e.Phaser.Sweep=M(-.3)),M()<.33&&(e.Frequency.ChangeSpeed=M(.3,.6),e.Frequency.ChangeAmount=M(24,-12)),p(e),e},Powerup:function(){var e=f();return M()<.5?e.Generator.Func="saw":e.Generator.A=M(.6),e.Frequency.Start=M(220,440),M()<.5?(e.Frequency.Slide=M(.5,.2),e.Frequency.RepeatSpeed=M(.4,.4)):(e.Frequency.Slide=M(.2,.05),M()<.5&&(e.Vibrato.Depth=M(.6,.1),e.Vibrato.Frequency=M(30,10))),e.Volume.Sustain=M(.4),e.Volume.Decay=M(.4,.1),p(e),e},Hit:function(){var e=f();return e.Generator.Func=L(["square","saw","noise"]),e.Generator.A=M(.6),e.Generator.ASlide=M(1,-.5),e.Frequency.Start=M(880,220),e.Frequency.Slide=-M(.4,.3),e.Volume.Sustain=M(.1),e.Volume.Decay=M(.2,.1),M()<.5&&(e.Filter.HP=M(.3)),p(e),e},Jump:function(){var e=f();return e.Generator.Func="square",e.Generator.A=M(.6),e.Frequency.Start=M(330,330),e.Frequency.Slide=M(.4,.2),e.Volume.Sustain=M(.3,.1),e.Volume.Decay=M(.2,.1),M()<.5&&(e.Filter.HP=M(.3)),M()<.3&&(e.Filter.LP=M(-.6,1)),p(e),e},Select:function(){var e=f();return e.Generator.Func=L(["square","saw"]),e.Generator.A=M(.6),e.Frequency.Start=M(660,220),e.Volume.Sustain=M(.1,.1),e.Volume.Decay=M(.2),e.Filter.HP=.2,p(e),e},Lucky:function(){var t=f();return P(t,function(t,n){P(e.Module[n].params,function(e,n){if(e.C){var r=F(e.C);t[n]=r[r.length*D()|0]}else t[n]=D()*(e.H-e.L)+e.L})}),t.Volume.Master=.4,t.Filter={},p(t),t}},e.G.unoise=d("sample = Math.random();"),e.G.sine=d("sample = Math.sin(phase);"),e.G.saw=d("sample = 2*(phase/TAU - ((phase/TAU + 0.5)|0));"),e.G.triangle=d("sample = Math.abs(4 * ((phase/TAU - 0.25)%1) - 2) - 1;"),e.G.square=d("var s = Math.sin(phase); sample = s > A ? 1.0 : s < A ? -1.0 : A;"),e.G.synth=d("sample = Math.sin(phase) + .5*Math.sin(phase/2) + .3*Math.sin(phase/4);"),e.G.noise=d("if(phase % TAU < 4){__noiseLast = Math.random() * 2 - 1;} sample = __noiseLast;"),e.G.string={create:function(){for(var e=65536,t=e-1,n=b(e),r=0;r<n.length;r++)n[r]=2*D()-1;var a=0;return function(r,o){for(var i=2*Math.PI,u=+r.generatorA,l=+r.generatorASlide,s=+r.generatorB,c=+r.generatorBSlide,h=n,f=0;f<o.length;f++){var p=o[f];u=(u+=l)<0?0:u>1?1:u,s=(s+=c)<0?0:s>1?1:s;var d=a-(i/p|0)+e&t,g=(1*h[d-0+e&t]+h[d-1+e&t]*u+h[d-2+e&t]*s)/(1+u+s);h[a]=g,o[f]=h[a],a=a+1&t}return r.generatorA=u,r.generatorB=s,o.length}}},e.CreateAudio=g,e.DownloadAsFile=function(e){S(e instanceof Audio,"input must be an Audio object"),document.location.href=e.src},e.Util={},e.Util.CopyFToU8=m,e._createFloatArray=b;var A=Math.random;function D(){return A()}e.setRandomFunc=function(e){A=e}}(n={}),e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);let a,o;t.Preset=r.Preset;let i,u,l={},s={},c=[];const h={c:t.Preset.Coin,l:t.Preset.Laser,e:t.Preset.Explosion,p:t.Preset.Powerup,h:t.Preset.Hit,j:t.Preset.Jump,s:t.Preset.Select,u:t.Preset.Lucky},f=function(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}(h);let p=.5,d=!1;function g(e){null!=a&&(a._volume.gain.value=e)}function m(){null!=a&&T(c,e=>e.stop())}let S;function y(e=32,t=.25,n,r=60,a=1,i=0,u=0,l=1,s=!1,c=!1,h=!1,f=!1,p=null){const d=new D(n,v(r),a);if(d.noteInterval=t,null!=S&&s)d.noteRatios=S.noteRatios;else{const t=null!=p?function(e,t){return B(e,()=>o.get()>=t)}(e,p):function(e){let t=x(e,!1),n=4;for(;n<=e;)t=P(t,n),n*=2;return t}(e);d.noteRatios=function(e,t,n,r,a){let i=o.get(),u=o.get(-.5,.5),l=e.length/F.length,s=[];return e.forEach((e,n)=>{let c=Math.floor(n/l),h=n%l;if(a&&c===Math.floor(F.length/2))return s.push(s[h]),void(null!=s[h]&&(i=s[h]));e?(s.push(i),u+=o.get(-.25,.25),i+=u*r,(o.get()<.2||i<=t||i>=1)&&(i-=2*u,u*=-1)):s.push(null)}),s}(t,c?0:-1,0,l,f)}return d.notes=function(e,t,n,r){let a=e.length/F.length;return e.map((e,i)=>{if(null==e)return null;let u=Math.floor(i/a),l=F[u][0],s=M[F[u][1]],c=e;r&&(c=Math.floor(2*c)/2);let h=Math.floor(c),f=Math.floor((c-h)*s.length);for(f+=t+o.getInt(-n,n+1);f>=s.length;)f-=s.length,h++;for(;f<0;)f+=s.length,h--;return 100*(l+12*h+s[f])})}(d.noteRatios,i,u,h),S=d,d}function v(e){return 440*Math.pow(2,(e-69)/12)}function P(e,t){let n=x(t,!1);const r=Math.floor(4*Math.abs(o.get()+o.get()-1));for(let a=0;a<r;a++)n[o.getInt(t-1)]=!0;return G(e,(e,r)=>n[r%t]?!e:e)}t.init=function(e=0,n=120,l=60){a=r.Live({}),g(.1),u=e,o=new H,r.setRandomFunc(o.get),t.playInterval=60/n,i=1/l*3},t.setSeed=function(e=0){u=e},t.play=function(e="0",t=2,n=null,r=null,i=null){if(null==a)return;if(null!=l[e])return void l[e].play(i);if(o.setSeed(u+w(e)),null==r){let n=h[e[0]];void 0===n&&(n=o.select(f)),r=x(t,n)}const s=null==n?null:v(n);l[e]=new A(r,s),l[e].play(i)},t.playJingle=function(e="0",t=!1,n=57,r=16,i=.25,l=4,c=null,p=null){if(null==a)return;if(null!=s[e])return void s[e].forEach(e=>e.play(p));if(o.setSeed(u+w(e)),b(),S=null,null==c){let t=h[e[0]];void 0===t&&(t=o.select(f)),c=t}let d=.8;t&&(i/=4,d/=2),s[e]=B(l,()=>{const e=Math.floor(3*Math.abs(o.get()+o.get()-1)),a=Math.floor(10*(o.get()+o.get()-1)),u=t?2:Math.abs(o.get()+o.get()-1),l=o.get()<.25,s=!t&&o.get()<.5,h=o.get()<.5,f=t?o.get()<.25:o.get()<.9,p=o.get(.5),g=y(r,i,c,n,d,e,a,u,l,s,h,f,p);return g.isLooping=!1,g}),s[e].forEach(e=>e.play(p))},t.stopJingles=function(){q(s,e=>T(e,e=>e.stop()))},t.setVolume=g,t.setQuantize=function(e){p=e},t.update=function(){if(null==a)return;const e=a._context.currentTime,t=e+i;return q(l,n=>n.update(e,t)),q(s,n=>T(n,n=>n.update(e,t))),T(c,n=>n.update(e,t)),e},t.reset=function(){m(),l={},s={},c=[]},t.playEmpty=function(){if(null==a)return;if(d)return;const e=a._createEmptyBuffer();a._playBuffer(e,0),d=!0},t.resumeAudioContext=function(){a._context.resume()},t.playParam=function(e){null!=a&&a._play(e)},t.playBgm=function(e="0",n=45,r=32,i=.25,l=4,s=[t.Preset.Laser,t.Preset.Select,t.Preset.Hit,t.Preset.Hit],h=null){if(null==a)return;m(),o.setSeed(u+w(e)),b(),S=null;let f=o.select(s);T(c=B(l,()=>{const e=Math.floor(3*Math.abs(o.get()+o.get()-1)),t=Math.floor(10*(o.get()+o.get()-1)),a=Math.abs(o.get()+o.get()-1),u=o.get()<.25;u||(f=o.select(s));const l=o.get()<.5,c=o.get()<.5,h=o.get()<.9;return y(r,i,f,n,.7,e,t,a,u,l,c,h)}),e=>e.play(h))},t.stopBgm=m;const M=[[0,4,7],[0,3,7],[0,4,7,10],[0,4,7,11],[0,3,7,10]],L=[[[0,0],[7,0],[9,1],[4,1]],[[5,0],[0,0],[5,0],[7,0]],[[5,3],[7,2],[4,4],[9,1]],[[9,1],[2,1],[7,0],[0,0]],[[9,1],[5,0],[7,0],[0,0]]];let F;function b(){const e=o.select(L);F=e.map((e,t)=>[o.get()<.7?e[0]:L[o.getInt(L.length)][t][0],o.get()<.7?e[1]:o.getInt(M.length)])}class A{constructor(e,t=null,n=1){this.isPlaying=!1,this.playedTime=null,Array.isArray(e)||(e=[e]),this.buffers=G(e,e=>(e instanceof Function&&(e=e()),e.Volume.Sustain*=n,e.Volume.Decay*=n,null!=t&&(e.Frequency.Start=t),a._createBuffer(e))),this.gainNode=a._createGain()}play(e=null){this.isPlaying=!0,this.volume=e}stop(){this.isPlaying=!1}update(e,n){if(!this.isPlaying)return;this.isPlaying=!1;const r=t.playInterval*p,a=r>0?Math.ceil(e/r)*r:e;(null==this.playedTime||a>this.playedTime)&&(this.playLater(a),this.playedTime=a)}playLater(e,t=null){null==this.volume?T(this.buffers,n=>a._playBuffer(n,e,t)):(this.gainNode.gain.value=this.volume,T(this.buffers,n=>a._playBufferAndConnect(n,e,this.gainNode,t)))}}class D extends A{constructor(){super(...arguments),this.noteIndex=0,this.noteInterval=.25,this.scheduledTime=null,this.isLooping=!0}play(e=null){super.play(e),this.scheduledTime=null}update(e,t){if(this.isPlaying){null==this.scheduledTime&&this.calcFirstScheduledTime(e);for(let t=0;t<9&&!(this.scheduledTime>=e)&&(this.calcNextScheduledTime(),this.isLooping||0!==this.noteIndex);t++);if(this.scheduledTime<e)this.isLooping?this.scheduledTime=null:this.stop();else for(;this.scheduledTime<=t;){if(null!=this.nextNote&&this.playLater(this.scheduledTime,this.nextNote),!this.isLooping&&0===this.noteIndex)return void this.stop();this.calcNextScheduledTime()}}}calcFirstScheduledTime(e){this.scheduledTime=Math.ceil(e/t.playInterval)*t.playInterval-t.playInterval*this.noteInterval,this.noteIndex=0,this.calcNextScheduledTime()}calcNextScheduledTime(){const e=this.notes.length,n=t.playInterval*this.noteInterval;for(let t=0;t<e&&(this.scheduledTime+=n,this.nextNote=this.notes[this.noteIndex],this.noteIndex++,!(this.noteIndex>=e)||(this.noteIndex=0,this.isLooping))&&null==this.nextNote;t++);}}class H{get(e=1,t=null){return null==t&&(t=e,e=0),this.getToMaxInt()/4294967295*(t-e)+e}getInt(e,t=null){return null==t&&(t=e,e=0),this.getToMaxInt()%(t-e)+e}getPm(){return 2*this.getInt(2)-1}select(e){return e[this.getInt(e.length)]}setSeed(e=null,t=123456789,n=362436069,r=521288629,a=32){this.w=null!=e?e>>>0:Math.floor(4294967295*Math.random())>>>0,this.x=t>>>0,this.y=n>>>0,this.z=r>>>0;for(let o=0;o<a;o++)this.getToMaxInt();return this}getToMaxInt(){const e=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=(this.w^this.w>>>19^e^e>>>8)>>>0,this.w}constructor(){this.setSeed(),this.get=this.get.bind(this),this.getToMaxInt=this.getToMaxInt.bind(this)}}function w(e){let t=0;const n=e.length;for(let r=0;r<n;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function x(e,t){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function B(e,t){let n=[];for(let r=0;r<e;r++)n.push(t(r));return n}function T(e,t){for(let n=0;n<e.length;n++)t(e[n])}function q(e,t){for(let n in e)t(e[n])}function G(e,t){let n=[];for(let r=0;r<e.length;r++)n.push(t(e[r],r));return n}}])});
},{}],"cZis":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var s={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(s[t]=e[t]);return s.default=e,s};Object.defineProperty(exports,"__esModule",{value:!0});const s=e(require("./keyboard")),t=e(require("./pointer")),r=e(require("./view")),o=e(require("./text")),i=e(require("sounds-some-sounds")),n=require("./vector"),a=require("./math");let l,u;exports.stickAngle=0,exports.isPressed=!1,exports.isJustPressed=!1,exports.isJustReleased=!1;let c=new n.Vector,p=new n.Vector;function d(e=!0,o=!1){l=e,u=o,c.set(r.size.x/2,r.size.y/2),s.init({onKeyDown:i.playEmpty,isUsingStickKeysAsButton:!0,isFourWaysStick:u}),t.init(r.canvas,r.size,{onPointerDownOrUp:i.playEmpty,anchor:new n.Vector(.5,.5)})}function P(){if(exports.stickAngle=-1,s.update(),s.stickAngle>=0&&(exports.stickAngle=s.stickAngle),t.update(),t.isPressed&&(t.isJustPressed&&t.setTargetPos(c),l&&(p.set(t.targetPos).sub(c),p.length>10))){const e=p.getAngle()/(Math.PI/4);exports.stickAngle=a.wrap(Math.round(e),0,8),u&&(exports.stickAngle=2*Math.floor(exports.stickAngle/2))}exports.isPressed=s.isPressed||t.isPressed,exports.isJustPressed=s.isJustPressed||t.isJustPressed,exports.isJustReleased=s.isJustReleased||t.isJustReleased}function x(){if(l&&t.isPressed){o.print("c",r.size.x/2-2,r.size.y/2-2,{colorPattern:"b",backgroundColorPattern:"t",symbolPattern:"s",alpha:.5});let e="c",s="k";exports.stickAngle>=0&&(e=exports.stickAngle%2==0?"a":"z",s="kljh".charAt(Math.floor(exports.stickAngle/2))),o.print(e,t.targetPos.x-2,t.targetPos.y-2,{colorPattern:"g",backgroundColorPattern:"t",symbolPattern:"s",rotationPattern:s,alpha:.5})}}function g(){s.clearJustPressed(),t.clearJustPressed()}exports.init=d,exports.update=P,exports.draw=x,exports.clearJustPressed=g;
},{"./keyboard":"kmeV","./pointer":"iUdv","./view":"YCKg","./text":"souV","sounds-some-sounds":"o5Dp","./vector":"HIZ7","./math":"pR4u"}],"iJGG":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(i[t]=e[t]);return i.default=e,i};Object.defineProperty(exports,"__esModule",{value:!0});const i=e(require("./view")),t=e(require("./text")),n=e(require("./input")),r=e(require("sounds-some-sounds"));let o,a,s=0;const u={viewSize:{x:126,y:126},bodyBackground:"#111",viewBackground:"black",isUsingVirtualPad:!0,isFourWaysStick:!1};let c,d=10;function l(e,i,t){o=e,a=i,c=Object.assign(Object.assign({},u),t),window.addEventListener("load",w)}function w(){i.init(c.viewSize,c.bodyBackground,c.viewBackground),n.init(c.isUsingVirtualPad,c.isFourWaysStick),t.init(),o(),f()}function f(){requestAnimationFrame(f);const e=window.performance.now();e-s<1e3/60-5||(s=e,r.update(),n.update(),a(),n.draw(),0===--d&&t.enableCache())}exports.init=l;
},{"./view":"YCKg","./text":"souV","./input":"cZis","sounds-some-sounds":"o5Dp"}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});const t=e(require("./level")),r=e(require("./generator")),n=e(require("./charPatterns")),o=e(require("./button")),i=e(require("../util/main")),s=e(require("../util/view")),a=e(require("../util/text")),l=require("../util/terminal"),c=e(require("../util/pointer")),p=require("../util/vector"),u=require("../util/random"),f=require("../util/math"),h=e(require("sounds-some-sounds"));let g;exports.terminalSize=new p.Vector(25,18);let y,d,m,w,x,S,v,q,E,O,P={inGame:$,solved:X},V=0,k=new p.Vector,C=new p.Vector,_=new p.Vector,b=new p.Vector;const A=new u.Random;let J,M,N;const I=14,L=30,R="soniper-100";function z(){h.init(306),h.setQuantize(0),y=new l.Terminal(exports.terminalSize),n.init(),t.init(),J=o.get({pos:new p.Vector(118,1),text:"RESET",onClick:F}),M=o.get({pos:new p.Vector(118,100),text:"UNDO",onClick:Q}),D()}function G(){s.clear(),t.terminal.draw(),P[g](),y.draw(),V++}function D(){null==(v=Y())&&(v=1),T()}function T(){g="inGame",V=0,ee(v),d=!1,m=!1,C.set(-1),x=[],q=0,E=-1,A.setSeed(v+I),b.set(f.clamp(Math.floor(A.get(Math.sqrt(2*v))),2,6),f.clamp(Math.floor(A.get(Math.sqrt(1.5*v))),2,4)),N=[],y.clear(),t.terminal.clear(),V=0}function $(){q>=0?U():(60===V&&y.clear(),x.length>0?H():(N.length>0&&(o.update(J),o.update(M)),j()))}function U(){if(16===q)return E<=0?t.setFromPatterns(0):r.generate(179*v+1087*O+I,b),q=-1,t.draw(),y.clear(),y.print(`LEVEL ${v}`,1,0),void h.playJingle("l0",!1,57,8);const e=r.generate(179*v+1087*q+I,b);e>E&&(E=e,O=q),q++,y.print(`GENERATING ${q} / 16`,1,0)}function j(){if(k.set(c.pos).div(6).floor(),k.isInRect(0,0,exports.terminalSize.x,exports.terminalSize.y)){const e=t.grid[k.x][k.y];if(d){C.equals(k)||(w=t.getPath(_,k,"push"),m=null!=w,C.set(k));const e=m?"H":"I";a.print(e,6*k.x,6*k.y,{symbol:"s"}),c.isJustReleased&&(null!=w&&(N.push({crateSourcePos:new p.Vector(_),crateDestinationPos:new p.Vector(k),keeperPos:new p.Vector(t.keeperPos),keeperAngle:t.keeperAngle}),K(w,_),h.play("s_rel")),d=!1,C.set(-1,-1))}else{C.equals(k)||(m=("crate"===e||"crate on dot"===e)&&t.getMovableAngles(k,"push").length>0,C.set(k));const r=m?"H":"I";a.print(r,6*k.x,6*k.y,{symbol:"s"}),m&&c.isJustPressed&&(_.set(k),d=!0,w=null,m=!1,h.play("s_prs"))}}d&&a.print("G",6*_.x,6*_.y,{symbol:"s"})}function H(){(S-=1)<=0&&(x[0].forEach(e=>{"crate"===e.char&&"disappear"===e.type&&t.removeCrate(e.pos)}),x.shift(),x.length>0&&x[0].forEach(e=>{"appear"===e.type&&("crate"===e.char?t.setCrate(e.pos):(t.setKeeper(e.pos,e.angle),h.play("h_kp")))}),S=4),t.draw(),0!==x.length?x[0].forEach(e=>{const t="appear"===e.type?S:4-S;a.print(String.fromCharCode("J".charCodeAt(0)+t),6*e.pos.x,6*e.pos.y,{symbol:"s"})}):t.checkSolved()&&W()}function K(e,r){let n=e[0];function o(e,r,n){const o=t.angleOffsets[r];x.push([{type:n,char:"crate",pos:{x:e.x,y:e.y}},{type:n,char:"keeper",pos:{x:e.x-o.x,y:e.y-o.y},angle:r}])}function i(e,n){const o=t.angleOffsets[n];x.push([{type:"disappear",char:"keeper",pos:e}]),x.push([{type:"appear",char:"keeper",pos:{x:r.x-o.x,y:r.y-o.y},angle:n}])}x=[],i(t.keeperPos,n),o(r,n,"disappear"),e.forEach((s,a)=>{if(a===e.length-1||s!==n){if(s!==n){o(r,n,"appear");const e=t.angleOffsets[n];i({x:r.x-e.x,y:r.y-e.y},s),o(r,s,"disappear"),n=s}a===e.length-1&&(r.add(t.angleOffsets[s]),o(r,s,"appear"))}r.add(t.angleOffsets[s])}),S=5}function F(){if(!(0===N.length||x.length>0)){for(h.play("s_res");N.length>0;)B();t.draw()}}function Q(){0===N.length||x.length>0||(h.play("s_und"),B(),t.draw())}function B(){const e=N.pop();t.removeCrate(e.crateDestinationPos),t.setCrate(e.crateSourcePos),t.setKeeper(e.keeperPos,e.keeperAngle)}function W(){g="solved",V=0,v===L?(y.print(`${v} LEVELS ARE SOLVED!`,1,0),y.print("CONGRATULATIONS!",1,1),h.playJingle("s_cng",!1,69)):(y.print("SOLVED",1,0),h.playJingle("l1",!1,69,8))}function X(){V>(v===L?300:60)&&(v++,T())}function Y(){let e=Z();if(null==e)try{e=JSON.parse(localStorage.getItem(R)).levelCount}catch(t){}if(null!=e)return(e=Math.floor(e))<1&&(e=1),e}function Z(){const e=window.location.search.substring(1);if(null==e)return;let t,r=e.split("&");for(let n=0;n<r.length;n++){const e=r[n].split("=");"l"===e[0]&&(t=e[1])}return null!=t?Number(t):void 0}function ee(e){te(e);try{localStorage.setItem(R,JSON.stringify({levelCount:e}))}catch(t){}}function te(e){let t=`${window.location.href.split("?")[0]}?l=${e}`;try{window.history.replaceState({},"",t)}catch(r){}}i.init(z,G,{viewSize:{x:150,y:108},isUsingVirtualPad:!1});
},{"./level":"IHdg","./generator":"L0ny","./charPatterns":"WJcb","./button":"zONe","../util/main":"iJGG","../util/view":"YCKg","../util/text":"souV","../util/terminal":"h6s3","../util/pointer":"iUdv","../util/vector":"HIZ7","../util/random":"iXZc","../util/math":"pR4u","sounds-some-sounds":"o5Dp"}]},{},["ZCfc"], null)